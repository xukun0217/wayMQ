<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>微麦可#活动终结者</title>

<link href="./css/bootstrap.css" rel="stylesheet">
<link href="./css/signin.css" rel="stylesheet">

<script type="text/javascript" src="./js/jquery.js"></script>
<script type="text/javascript" src="./js/waymq.js"></script>
<script type="text/javascript">
	function setupButtonHandler() {

		$("#button_create_event").click(function() {

			createEvent();

		});

	}

	function loadGroupInfo() {

		var id = getURLQueryParameter(document.URL, "id");
		var url = new URLBuilder("Group", "getInfo");
		url.id = id;
		$.getJSON(url.toString(), function(json, status, xhr) {

			//			var str = JSON.stringify(json);
			//		alert(str);

			$("#info_name").text(json.name);
			$("#info_title").text(json.title);
			$("#info_description").text(json.description);

		});

	}

	function checkGroupExists() {

		var id = getURLQueryParameter(document.URL, "id");
		var url = new URLBuilder("Group", "exists");
		url.id = id;
		$.getJSON(url.toString(), function(json, status, xhr) {

			//	var str = JSON.stringify(json);
			//	alert(str);

			if (json.success) {
				if (!json.exists) {
					// goto 404
					window.location = "http404.html";
				}
			}

			//		window.location = "http404.html";

		});

	}

	function createEvent() {

		var title = $("#edit_title").val();
		var time = $("#edit_time").val();
		var content = $("#edit_content").val();

		var url = "do?class=WAYMQ";
		url = url + "&do=" + "newEvent";
		url = url + "&title=" + title;
		url = url + "&time=" + time;
		url = url + "&content=" + content;

		$.getJSON(url, function(data) {
			var str = JSON.stringify(data);
			alert(str);
		});

	}

	$(document).ready(function() {

		setupButtonHandler();
		loadGroupInfo();
		checkGroupExists();

	});
</script>

</head>
<body>

	<div>微麦可#活动终结者::group</div>


	<div class="container">


		<div id="info_title"></div>


		<form class="form-signin" role="form">




			<!-- info -->
			<div id="view_group_info">
				<div id="info_name"></div>
				<div id="info_description"></div>
			</div>


			<!-- settings -->
			<div id="view_group_settings"></div>


			<!-- new event -->
			<div id="view_create_event">

				<h2 class="form-signin-heading">创建活动</h2>

				<!-- title -->
				<input id="edit_title" type="text" class="form-control"
					placeholder="标题" value="aaa" required autofocus>
				<!-- time -->
				<input id="edit_time" type="text" class="form-control"
					placeholder="时间" value="bbb" required>
				<!-- content -->
				<input id="edit_content" type="text" class="form-control"
					placeholder="内容" value="ccc" required> <br /> <br />

				<!-- button -->
				<a id="button_create_event" href="#"
					class="btn btn-lg btn-primary btn-block">创建</a>

			</div>
		</form>

	</div>



</body>
</html>