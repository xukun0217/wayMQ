<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>注册</title>

<script type="text/javascript"
	src="http://ajax.microsoft.com/ajax/jquery/jquery-1.4.min.js"></script>

<script type="text/javascript" src="js/waymq.js"></script>


<script type="text/javascript">
	var mq = new WayMQ();

	function doInit() {
		$("#button_get_passwd").click(function() {

			var phone_num = $("#edit_phone_num").val();

			if (phone_num == null)
				phone_num = "";
			if (phone_num.length != 11) {
				alert("input a phone number!");
				return;
			}

			var req = mq.request("Sign");
			req.setParam("do", "passwd");
			req.setParam("pn", phone_num);

			req.send(function(url, json) {
				var code = mq.alertHttpError(url, json, true);
				if (code == 200) {
					alert("please wait your passwd by sms!");
				}
			});

		});

		$("#button_sign_up").click(function() {

			var phone = $("#edit_phone_num").val();
			var psw = $("#edit_passwd").val();

			var req = mq.request("Sign");
			req.setParam("do", "up");
			req.setParam("pn", phone);
			req.setParam("pw", psw);
			req.send(function(url, json) {
				var code = mq.alertHttpError(url, json, true);
				if (code != 200) {
					return;
				}
				var state = json["state"];
				if (state == "on") {
					mq.goto_url("home.html");
				} else {
					alert("failed to sign up!");
				}

			});

		});
	}

	$(document).ready(function() {

		doInit();
	});
</script>

</head>
<body>

	<div>
		<div>
			<div>phone</div>
			<input id="edit_phone_num" type="text" />
		</div>

		<div>
			<div>name</div>
			<input id="edit_name" type="text" />
		</div>

		<div>
			<div>passwd</div>
			<input id="edit_passwd" type="text" />
			<button id="button_get_passwd">get pass</button>
		</div>

		<div>
			<button id="button_sign_up">sign up</button>
		</div>

	</div>

</body>
</html>